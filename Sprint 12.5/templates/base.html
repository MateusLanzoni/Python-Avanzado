<!DOCTYPE html>
{% load static %}
<html lang="es" data-bs-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Clínica Veterinaria{% endblock %}</title>
  <meta name="description" content="Sistema integral de gestión veterinaria - Cuidamos a tus mascotas con amor y profesionalismo">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🐾</text></svg>">
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="{% static 'css/estilo.css' %}">
</head>
<body>

<!-- Loading Spinner -->
<div id="loading-spinner" class="loading-overlay">
  <div class="spinner-border text-primary" role="status">
    <span class="visually-hidden">Cargando...</span>
  </div>
</div>

<!-- Scroll to Top Button -->
<button id="scroll-to-top" class="btn btn-primary scroll-to-top" title="Volver arriba">
  <i class="fas fa-chevron-up"></i>
</button>

<nav class="navbar navbar-expand-lg navbar-dark bg-gradient-primary sticky-top">
  <div class="container">
    <a class="navbar-brand animated-brand" href="{% url 'home' %}">
      <i class="fas fa-heartbeat"></i> 
      <span class="brand-text">Clínica Veterinaria</span>
    </a>
    
    <!-- Theme Toggle -->
    <button class="btn btn-outline-light btn-sm me-2 d-none d-lg-block" id="theme-toggle" title="Cambiar tema">
      <i class="fas fa-moon" id="theme-icon"></i>
    </button>
    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto">
        <li class="nav-item">
          <a class="nav-link nav-link-animated" href="{% url 'home' %}">
            <i class="fas fa-home"></i> <span>Inicio</span>
          </a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle nav-link-animated" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">
            <i class="fas fa-users"></i> <span>Gestión</span>
          </a>
          <ul class="dropdown-menu dropdown-menu-modern">
            <li><a class="dropdown-item" href="{% url 'propietarios_lista' %}"><i class="fas fa-user text-primary"></i> Propietarios</a></li>
            <li><a class="dropdown-item" href="{% url 'mascotas_lista' %}"><i class="fas fa-paw text-warning"></i> Mascotas</a></li>
            <li><a class="dropdown-item" href="{% url 'veterinarios_lista' %}"><i class="fas fa-user-md text-success"></i> Veterinarios</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="{% url 'medicamentos_lista' %}"><i class="fas fa-pills text-info"></i> Medicamentos</a></li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle nav-link-animated" href="#" id="navbarDropdown2" role="button" data-bs-toggle="dropdown">
            <i class="fas fa-calendar-check"></i> <span>Atención</span>
          </a>
          <ul class="dropdown-menu dropdown-menu-modern">
            <li><a class="dropdown-item" href="{% url 'citas_lista' %}"><i class="fas fa-calendar-alt text-primary"></i> Citas</a></li>
            <li><a class="dropdown-item" href="{% url 'bitacoras_lista' %}"><i class="fas fa-clipboard-list text-success"></i> Consultas</a></li>
            <li><a class="dropdown-item" href="{% url 'cirugias_lista' %}"><i class="fas fa-procedures text-danger"></i> Cirugías</a></li>
          </ul>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle nav-link-animated" href="#" id="navbarDropdown3" role="button" data-bs-toggle="dropdown">
            <i class="fas fa-download"></i> <span>Exportar</span>
          </a>
          <ul class="dropdown-menu dropdown-menu-modern">
            <li><a class="dropdown-item" href="{% url 'exportar_propietarios' %}"><i class="fas fa-file-csv text-success"></i> Propietarios CSV</a></li>
            <li><a class="dropdown-item" href="{% url 'exportar_mascotas' %}"><i class="fas fa-file-csv text-info"></i> Mascotas CSV</a></li>
          </ul>
        </li>
      </ul>
      
      <!-- Enlaces de autenticación -->
      <ul class="navbar-nav">
        {% if user.is_authenticated %}
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle user-dropdown" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
              <div class="user-avatar">
                <i class="fas fa-user"></i>
              </div>
              <span class="user-name">{{ user.username }}</span>
            </a>
            <ul class="dropdown-menu dropdown-menu-end dropdown-menu-modern">
              <li><h6 class="dropdown-header"><i class="fas fa-user-circle"></i> Mi Cuenta</h6></li>
              <li><a class="dropdown-item" href="#"><i class="fas fa-cog text-secondary"></i> Configuración</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item text-danger" href="{% url 'logout' %}"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</a></li>
            </ul>
          </li>
        {% else %}
          <li class="nav-item">
            <a class="nav-link nav-link-animated btn-outline-light-custom" href="{% url 'login' %}">
              <i class="fas fa-sign-in-alt"></i> <span>Iniciar Sesión</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link nav-link-animated btn-light-custom" href="{% url 'register' %}">
              <i class="fas fa-user-plus"></i> <span>Registrarse</span>
            </a>
          </li>
        {% endif %}
        
        <!-- Theme Toggle Mobile -->
        <li class="nav-item d-lg-none">
          <button class="nav-link btn btn-outline-light btn-sm" id="theme-toggle-mobile">
            <i class="fas fa-moon" id="theme-icon-mobile"></i> Cambiar tema
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Mensajes con animaciones -->
{% if messages %}
  <div class="container mt-3">
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }} alert-dismissible fade show alert-modern animate__animated animate__fadeInDown" role="alert">
        <div class="d-flex align-items-center">
          {% if message.tags == 'success' %}
            <i class="fas fa-check-circle me-2"></i>
          {% elif message.tags == 'error' %}
            <i class="fas fa-exclamation-triangle me-2"></i>
          {% elif message.tags == 'warning' %}
            <i class="fas fa-exclamation-circle me-2"></i>
          {% else %}
            <i class="fas fa-info-circle me-2"></i>
          {% endif %}
          <span>{{ message }}</span>
        </div>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
      </div>
    {% endfor %}
  </div>
{% endif %}

<main class="main-content">
  {% block content %}
  {% endblock %}
</main>

<!-- Footer -->
<footer class="bg-dark text-light py-4 mt-5">
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        <h5><i class="fas fa-heartbeat text-primary"></i> Clínica Veterinaria</h5>
        <p class="mb-0">Cuidamos a tus mascotas con amor y profesionalismo desde 2025.</p>
      </div>
      <div class="col-md-6 text-md-end">
        <small>&copy; 2025 Clínica Veterinaria. Todos los derechos reservados.</small>
        <div class="mt-2">
          <a href="#" class="text-light me-3"><i class="fab fa-facebook"></i></a>
          <a href="#" class="text-light me-3"><i class="fab fa-instagram"></i></a>
          <a href="#" class="text-light"><i class="fab fa-whatsapp"></i></a>
        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- Custom JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Hide loading spinner
  setTimeout(() => {
    document.getElementById('loading-spinner').style.display = 'none';
  }, 500);

  // Theme Toggle
  const themeToggle = document.getElementById('theme-toggle');
  const themeToggleMobile = document.getElementById('theme-toggle-mobile');
  const themeIcon = document.getElementById('theme-icon');
  const themeIconMobile = document.getElementById('theme-icon-mobile');
  const htmlElement = document.documentElement;

  function toggleTheme() {
    const currentTheme = htmlElement.getAttribute('data-bs-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    
    htmlElement.setAttribute('data-bs-theme', newTheme);
    localStorage.setItem('theme', newTheme);
    
    // Update icons
    const iconClass = newTheme === 'dark' ? 'fa-sun' : 'fa-moon';
    if (themeIcon) themeIcon.className = `fas ${iconClass}`;
    if (themeIconMobile) themeIconMobile.className = `fas ${iconClass}`;
  }

  // Load saved theme
  const savedTheme = localStorage.getItem('theme') || 'light';
  htmlElement.setAttribute('data-bs-theme', savedTheme);
  if (savedTheme === 'dark') {
    if (themeIcon) themeIcon.className = 'fas fa-sun';
    if (themeIconMobile) themeIconMobile.className = 'fas fa-sun';
  }

  if (themeToggle) themeToggle.addEventListener('click', toggleTheme);
  if (themeToggleMobile) themeToggleMobile.addEventListener('click', toggleTheme);

  // Scroll to top button
  const scrollToTopBtn = document.getElementById('scroll-to-top');
  
  window.addEventListener('scroll', function() {
    if (window.pageYOffset > 300) {
      scrollToTopBtn.classList.add('show');
    } else {
      scrollToTopBtn.classList.remove('show');
    }
  });

  scrollToTopBtn.addEventListener('click', function() {
    window.scrollTo({
      top: 0,
      behavior: 'smooth'
    });
  });

  // Auto-dismiss alerts
  const alerts = document.querySelectorAll('.alert');
  alerts.forEach(alert => {
    setTimeout(() => {
      const bsAlert = new bootstrap.Alert(alert);
      bsAlert.close();
    }, 5000);
  });

  // Add loading state to forms
  const forms = document.querySelectorAll('form');
  forms.forEach(form => {
    form.addEventListener('submit', function() {
      const submitBtn = form.querySelector('button[type="submit"]');
      if (submitBtn) {
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Procesando...';
        submitBtn.disabled = true;
      }
    });
  });

  // Enhance dropdown animations
  const dropdowns = document.querySelectorAll('.dropdown-toggle');
  dropdowns.forEach(dropdown => {
    dropdown.addEventListener('show.bs.dropdown', function() {
      const menu = this.nextElementSibling;
      menu.style.animation = 'fadeInDown 0.3s ease-out';
    });
  });
});
</script>

</body>
</html>